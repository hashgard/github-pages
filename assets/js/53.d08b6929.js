(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{200:function(t,e,a){"use strict";a.r(e);var s=a(0),r=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[t._m(0),t._v(" "),a("div",{staticClass:"danger custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("Warning")]),t._v(" "),a("p",[t._v("The following instructions are a brief walkthrough and not a comprehensive guideline. You should consider and "),a("router-link",{attrs:{to:"./security.html"}},[t._v("research more about the security implications")]),t._v(" of activating an external KMS.")],1)]),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),a("p",[t._v("You should be able to find the Tendermint app in Ledger Live.")]),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),a("p",[t._v("In this section, we will configure a KMS to use a Ledger device running the Tendermint Validator App.")]),t._v(" "),t._m(5),t._v(" "),a("p",[t._v("You can find other configuration examples "),a("a",{attrs:{href:"https://github.com/tendermint/kms/blob/master/tmkms.toml.example",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1)]),t._v(" "),t._m(6),t._v(" "),t._m(7),t._m(8),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),a("p",[t._v("Now you need to generate secret_key:")]),t._v(" "),t._m(11),t._m(12),t._v(" "),t._m(13),t._v(" "),a("p",[t._v("Start the KMS:")]),t._v(" "),t._m(14),a("p",[t._v("The output should look similar to:")]),t._v(" "),t._m(15),a("p",[t._v("The KMS may complain that it cannot connect to hashgard. That is fine, we will fix it in the next section.")]),t._v(" "),t._m(16),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),a("p",[t._v("For example:")]),t._v(" "),t._m(20),t._m(21),t._v(" "),t._m(22),t._m(23),t._v(" "),a("p",[t._v("Once the ledger receives the first message, it will ask for confirmation that the values are adequate.")]),t._v(" "),t._m(24),t._v(" "),a("p",[t._v("Click the right button, if the height and round are correct.")]),t._v(" "),a("p",[t._v("After that, you will see that the KMS will start forwarding all signature requests to the ledger:")]),t._v(" "),t._m(25),t._v(" "),t._m(26)])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"setting-up-tendermint-kms-ledger"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#setting-up-tendermint-kms-ledger","aria-hidden":"true"}},[this._v("#")]),this._v(" Setting up Tendermint KMS + Ledger")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"danger custom-block"},[e("p",{staticClass:"custom-block-title"},[this._v("Warning")]),this._v(" "),e("p",[this._v("KMS and Ledger Tendermint app are currently work in progress. Details may vary. Use with care under your own risk.")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"tendermint-validator-app-for-ledger-devices"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#tendermint-validator-app-for-ledger-devices","aria-hidden":"true"}},[this._v("#")]),this._v(" Tendermint Validator app (for Ledger devices)")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("em",[this._v("Note: at the moment, you might need to enable "),e("code",[this._v("developer mode")]),this._v(" in Ledger Live settings")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"kms-configuration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#kms-configuration","aria-hidden":"true"}},[this._v("#")]),this._v(" KMS configuration")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"config-file"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#config-file","aria-hidden":"true"}},[this._v("#")]),this._v(" Config file")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("Create a "),e("code",[this._v("~/.tmkms/tmkms.toml")]),this._v(" file with the following content (use an adequate "),e("code",[this._v("chain_id")]),this._v(")")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Example KMS configuration file")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("validator")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("addr")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tcp://localhost:26658"')]),t._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# or "unix:///path/to/socket"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("chain_id")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gaia-11001"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("reconnect")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# true is the default")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("secret_key")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"~/.tmkms/secret_connection.key"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token table class-name"}},[t._v("providers.ledgertm")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("chain_ids")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gaia-11001"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",[a("li",[t._v("Edit "),a("code",[t._v("addr")]),t._v(" to point to your "),a("code",[t._v("hashgard")]),t._v(" instance.")]),t._v(" "),a("li",[t._v("Adjust "),a("code",[t._v("chain-id")]),t._v(" to match your "),a("code",[t._v(".hashgard/config/config.toml")]),t._v(" settings.")]),t._v(" "),a("li",[a("code",[t._v("provider.ledgertm")]),t._v(" has not additional parameters at the moment, however, it is important that you keep that header to enable the feature.")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("em",[this._v("Plug your Ledger device and open the Tendermint validator app.")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"generate-secret-key"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#generate-secret-key","aria-hidden":"true"}},[this._v("#")]),this._v(" Generate secret key")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[this._v("tmkms keygen ~/.tmkms/secret_connection.key\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"retrieve-validator-key"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#retrieve-validator-key","aria-hidden":"true"}},[this._v("#")]),this._v(" Retrieve validator key")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("The last step is to retrieve the validator key that you will use in "),e("code",[this._v("hashgard")]),this._v(".")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[this._v("tmkms start -c ~/.tmkms/tmkms.toml\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-text extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("07:28:24 [INFO] tmkms 0.3.0 starting up...\n07:28:24 [INFO] [keyring:ledgertm:ledgertm] added validator key gardvalconspub1zcjduepqy53m39prgp9dz3nz96kaav3el5e0th8ltwcf8cpavqdvpxgr5slsd6wz6f\n07:28:24 [INFO] KMS node ID: 1BC12314E2E1C29015B66017A397F170C6ECDE4A\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("This output indicates the validator key linked to this particular device is: "),e("code",[this._v("gardvalconspub1zcjduepqy53m39prgp9dz3nz96kaav3el5e0th8ltwcf8cpavqdvpxgr5slsd6wz6f")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Take note of the validator pubkey that appears in your screen. "),e("em",[this._v("We will use it in the next section.")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"hashgard-configuration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#hashgard-configuration","aria-hidden":"true"}},[this._v("#")]),this._v(" Hashgard configuration")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("You need to enable KMS access by editing "),e("code",[this._v(".hashgard/config/config.toml")]),this._v(". In this file, modify "),e("code",[this._v("priv_validator_laddr")]),this._v(" to create a listening address/port or a unix socket in "),e("code",[this._v("hashgard")]),this._v(".")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"language-toml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-toml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# TCP or UNIX socket address for Tendermint to listen on for")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# connections from an external PrivValidator process")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key property"}},[t._v("priv_validator_laddr")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tcp://127.0.0.1:26658"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Let's assume that you have set up your validator account and called it "),e("code",[this._v("kmsval")]),this._v(". You can tell hashgard the key that we've got in the previous section.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[this._v("hashgard gentx --name kmsval --pubkey "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[this._v("{")]),this._v(".ValidatorKey"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[this._v("}")]),this._v(" \n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Now start "),e("code",[this._v("hashgard")]),this._v(". You should see that the KMS connects and receives a signature request.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"ledger_1.jpg",alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:"ledger_2.jpg",alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"danger custom-block"},[e("p",{staticClass:"custom-block-title"},[this._v("Warning")]),this._v(" "),e("p",[this._v("The word TEST in the second picture, second line appears because they were taken on a pre-release version.")]),this._v(" "),e("p",[this._v("Once the app as been released in Ledger's app store, this word should NOT appear.")])])}],!1,null,null,null);e.default=r.exports}}]);