(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{207:function(e,t,i){"use strict";i.r(t);var s=i(0),a=Object(s.a)({},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"content"},[e._m(0),e._v(" "),i("p",[e._v("Gitian is the deterministic build process that is used to build the Hashgard executables. It provides a way to be reasonably sure that the executables are really built from the git source. It also makes sure that the same, tested dependencies are used and statically built into the executable.")]),e._v(" "),i("p",[e._v('Multiple developers build the source code by following a specific descriptor ("recipe"), cryptographically sign the result, and upload the resulting signature. These results are compared and only if they match, the build is accepted and provided for download.')]),e._v(" "),i("p",[e._v("More independent Gitian builders are needed, which is why this guide exists. It is preferred you follow these steps yourself instead of using someone else's VM image to avoid 'contaminating' the build.")]),e._v(" "),i("p",[e._v("This page contains all instructions required to build and sign reproducible Hashgard binaries for Linux, Mac OS X, and Windows.")]),e._v(" "),e._m(1),e._v(" "),i("p",[e._v("Make sure your system satisfy minimum requisites as outlined in https://github.com/devrandom/gitian-builder#prerequisites.")]),e._v(" "),e._m(2),e._v(" "),e._m(3),e._v(" "),e._m(4),e._m(5),e._v(" "),i("p",[e._v("Clone cosmos-sdk:")]),e._v(" "),e._m(6),i("p",[e._v("Checkout the commit, branch, or release tag you want to build:")]),e._v(" "),e._m(7),e._m(8),e._v(" "),e._m(9),i("p",[e._v("The above command generates two directories in the current working directory:")]),e._v(" "),e._m(10),e._v(" "),e._m(11),e._v(" "),e._m(12),e._m(13),e._v(" "),e._m(14),e._m(15),e._v(" "),e._m(16),e._v(" "),e._m(17),e._v(" "),i("p",[e._v("Once signatures are generated, they could be uploaded to gaia's dedicated repository: https://gitlab.hashgard.com/hashgard/hashgard.sigs.\nThe build script can take care of cloning the signatures repository and commit the signed result too:")]),e._v(" "),e._m(18),e._m(19),e._v(" "),e._m(20),e._v(" "),i("p",[e._v("The issue is due to a relatively recent kernel apparmor change, "),i("a",{attrs:{href:"https://github.com/moby/moby/issues/36809#issuecomment-379325713",target:"_blank",rel:"noopener noreferrer"}},[e._v("see here"),i("OutboundLink")],1),e._v(" for more information on a potential mitigation for the issue.")]),e._v(" "),e._m(21),e._v(" "),e._m(22)])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"build-hashgard-deterministically"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#build-hashgard-deterministically","aria-hidden":"true"}},[this._v("#")]),this._v(" Build Hashgard Deterministically")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"prerequisites"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites","aria-hidden":"true"}},[this._v("#")]),this._v(" Prerequisites")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("All the following instructions have been tested on "),t("em",[this._v("Ubuntu 18.04.2 LTS")]),this._v(" with "),t("em",[this._v("docker 18.06.1-ce")]),this._v(" and "),t("em",[this._v("docker 18.09.6-ce")]),this._v(".")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("If you are on Mac OS X, make sure you have prepended your "),t("code",[this._v("PATH")]),this._v(" environment variable with GNU coreutils's path before running the build script:")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("export PATH=/usr/local/opt/coreutils/libexec/gnubin/:$PATH\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"build-and-sign"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#build-and-sign","aria-hidden":"true"}},[this._v("#")]),this._v(" Build and sign")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("git clone git@github.com:cosmos/gaia\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("cd gaia/\ngit checkout v0.35.0\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Run the following command to launch a build for "),t("code",[this._v("linux")]),this._v(" and sign the final build\nreport (replace "),t("code",[this._v("user@example.com")]),this._v(" with the GPG identity you want to sign the report with):")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("./contrib/gitian-build.sh -s user@example.com linux\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("ul",[t("li",[t("code",[this._v("gitian-build-linux")]),this._v(" containing the "),t("code",[this._v("gitian-builder")]),this._v(" clone used to drive the build process.")]),this._v(" "),t("li",[t("code",[this._v("gaia.sigs")]),this._v(" containing the signed build report.")])])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("p",[e._v("Replace "),i("code",[e._v("linux")]),e._v(" in the above command with "),i("code",[e._v("darwin")]),e._v(" or "),i("code",[e._v("windows")]),e._v(" to run builds for Mac OS X and Windows respectively.\nRun the following command to build binaries for all platforms ("),i("code",[e._v("darwin")]),e._v(", "),i("code",[e._v("linux")]),e._v(", and "),i("code",[e._v("windows")]),e._v("):")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("cd gaia/ && ./contrib/gitian-build.sh -s user@example.com all\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("If you want to generate unsigned builds, just remove the option "),t("code",[this._v("-s")]),this._v(" from the command line:")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("./contrib/gitian-build.sh linux\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("At the end of the procedure, build results can be found in the "),t("code",[this._v("./gaia.sigs")]),this._v(" directory:")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Please refer to the "),t("code",[this._v("contrib/gitian-build.sh")]),this._v("'s help screen for further information on its usage.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"signatures-upload"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#signatures-upload","aria-hidden":"true"}},[this._v("#")]),this._v(" Signatures upload")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("./contrib/gitian-build.sh -c -s user@example.com all\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"troubleshooting"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#troubleshooting","aria-hidden":"true"}},[this._v("#")]),this._v(" Troubleshooting")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"docker-gitian-target-container-cannot-be-killed"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-gitian-target-container-cannot-be-killed","aria-hidden":"true"}},[this._v("#")]),this._v(" Docker gitian-target container cannot be killed")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("On Ubuntu 18.04, when the container hangs and "),t("code",[this._v("docker")]),this._v(" is unable to kill it you can try to use "),t("code",[this._v("pkill")]),this._v(" to forcibly terminate "),t("code",[this._v("containerd-shim")]),this._v(":")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("sudo pkill containerd-shim\ndocker system prune\n")])])])}],!1,null,null,null);t.default=a.exports}}]);